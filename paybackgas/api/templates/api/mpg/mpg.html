{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}
<h2>MPG Calculator</h2>
{{ form.as_p }}
<p>make</p>
<div id='id_make'></div>
{% csrf_token %}
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>
    console.log('HEllo')
    $('#id_year').change(function() {
        console.log('something changed');
        var yearVal = $(this).val();
        var year = 1984 + parseInt(yearVal);
        console.log('year is ', year);
        var url = 'https://fueleconomy.gov/ws/rest/vehicle/menu/make?year=' + year.toString();
        console.log(url);

        $.ajax({
            url: url,
            data: {
            'year': year
            },
            success: function(responseData) {
                console.log(responseData); // #document -> <menuItems><menuItem>....</menuItems>
                var makeList = responseData.getElementsByTagName('menuItems')[0].childNodes;
                // console.log(makeList);
                console.log(makeList.length);
                for(var i=0; i < makeList.length; i++) {
                    console.log(makeList[i].getElementsByTagName('value')[0]['textContent']);
                }
                debugger;
            }
            
        })
    });
</script>
{% endblock %}