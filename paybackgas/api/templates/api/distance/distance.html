{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}

<form class="form-horizontal" method="POST" action="">
        {% csrf_token %}
        {{ formset.management_form }}
        {% for form in formset %}
            <div class='destination'>
                {{ form.destination }}
            </div>
        {% endfor %}
        <input type="button" value="Add Destination" id="add_destination">
        <input type="submit" value='Determine Distance Traveled'>
        </form>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script>
    function cloneMore(selector, type) {
        console.log(type);
        var newElement = $(selector).clone(true);
        var total = $('#id_' + type + '-TOTAL_FORMS').val();
        newElement.find(':input').each(function() {
            var name = $(this).attr('name').replace('-' + (total-1) + '-','-' + total + '-');
            var id = 'id_' + name;
            $(this).attr({'name': name, 'id': id}).val('').removeAttr('checked');
        });
        total ++;
        $('#id_' + type + '-TOTAL-FORMS').val(total);
        $(selector).after(newElement)
    }
    
    $('#add_destination').click(function() {
        cloneMore('div.destination:last', 'service')
    })
</script>
{% endblock %}